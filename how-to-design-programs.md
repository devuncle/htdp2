# 标题

## 3 怎样设计程序

学习编程需要掌握许多概念。另一方面，编程需要一门语言。尽管编程语言和自然语言有一些相通的地方，比如词汇，语法和成语。编程语言是人造的东西（artificial constructions）。
另一方面，学习如何把一个问题的说明转化为程序是很关键的。我们要学会取舍，找出程序的输入、输出，如何关联。我们必须知道或找出所选语言及其库是否为程序要处理的数据提供某些基本操作。

所有这些听起来都相当复杂，您可能想知道为什么我们不只是迷路，在这里和那里进行实验，当结果看起来不错时，就独自留下足够的空间。 这种编程方法通常被称为“车库编程”，并且在许多场合都成功。 有时它是创业公司的启动平台。 但是，初创公司无法出售“车库工作”的结果，因为只有原始的程序员及其朋友才能使用它们。 一个好的程序附带简短的说明，解释它的功能，期望的输入以及产生的结果。 理想情况下，还可以保证它确实有效。 在最佳情况下，程序与问题陈述的联系显而易见，因此对问题陈述的微小更改很容易转化为对程序的微小更改。 软件工程师将此称为“编程产品”。

所有这些额外的工作都是必要的，因为程序员不会自己创建程序。程序员编写程序供其他程序员阅读，有时，人们会运行这些程序来完成工作。大多数程序都是大型，复杂的协作功能集合，没有人一天可以编写所有这些功能。程序员加入项目，编写代码，离开项目；其他人接管他们的程序并继续努力。另一个困难是，程序员的客户倾向于对他们真正想要解决的问题改变主意。他们通常都说对了，但更多的是，他们弄错了一些细节。更糟糕的是，诸如程序之类的复杂逻辑结构几乎总是遭受人为错误的困扰。简而言之，程序员会犯错误。最终有人发现了这些错误，程序员必须修复它们。他们需要从一个月前，一年前或二十年前重新读取程序并进行更改。

在这里，我们提出了一个设计方案，该方案将分步过程与围绕问题数据组织程序的方式相集成。 对于长时间不喜欢盯着黑屏的读者来说，本设计诀窍提供了一种系统地取得进步的方法。 对于那些教别人设计程序的人来说，食谱是诊断新手困难的一种工具。 对于其他人，我们的食谱可能可以应用于其他领域，例如医学，新闻或工程。 对于那些希望成为真正的程序员的人来说，设计秘诀还提供了一种理解和使用现有程序的方法，尽管并非所有程序员都使用这种设计秘诀来编写程序。 本章的其余部分专门介绍进入设计配方世界的第一步。 以下各章和各部分以一种或另一种方式完善和扩展了配方。

### 3.1 函数设计

#### **信息与数据**

程序的目的是描述消耗一些信息并产生新信息的计算过程。从这个意义上讲，程序就像数学老师给小学学生的指令一样。但是，与学生不同的是，该程序不仅可以处理数字，还可以使用导航信息进行计算，查找人员的地址，打开开关或检查视频游戏的状态。所有这些信息都来自真实世界的一部分（通常称为程序域），而程序的计算结果表示该域中的更多信息。

信息在我们的描述中起着核心作用。将信息视为有关程序领域的事实。对于处理家具目录的程序，信息为“五脚桌子”或“两米两米的方桌”。一个游戏程序处理的是另一种领域，其中“五个”可能是指某个对象从画布的一部分到另一部分在每个时钟滴答中移动的像素数。或者，薪资计划可能会处理“五个抵扣”。

要使程序处理信息，它必须以编程语言将其转换为某种形式的数据。然后处理数据；完成后，它将生成的数据再次转换为信息。交互式程序甚至可以混合这些步骤，根据需要从世界获取更多信息，并在两者之间传递信息。

我们使用BSL和DrRacket，因此您不必担心将信息转换为数据的麻烦。在DrRacket的BSL中，您可以将函数直接应用于数据并观察其产生的结果。结果，我们避免了编写将信息转换为数据，反之亦然的函数的严重问题。对于简单的信息来说，设计这样的程序很简单。对于除简单信息以外的任何内容，例如，您需要了解解析，而这立即需要程序设计方面的大量专业知识。

软件工程师使用标语模型视图控制器（MVC）作为BSL和DrRacket将数据处理从解析信息转换为数据以及将数据转换为信息的方式。的确，尽管大多数入门书籍仍将它们分开，但精心设计的软件系统可以实现这种分离，这已成为公认的智慧。因此，使用BSL和DrRacket可以使您专注于程序核心的设计，并且，如果您有足够的经验，则可以学习设计信息/数据转换部分。

在这里，我们使用两个预装的示教包来演示数据和信息的分离：2htdp / batch-io和2htdp / universe。 从本章开始，我们为批处理程序和交互式程序开发设计配方，以使您了解如何设计完整的程序。 请记住，成熟的编程语言库为完整的程序提供了更多的上下文，并且您将需要适当地调整设计方法。

到目前为止，您已经遇到了四类数据的名称：Number，String，Image和Boolean。 这样，制定新的数据定义仅意味着为现有数据形式引入新名称，例如数字的“温度”。 即使是这种有限的知识也足以解释我们的设计过程的概要。

**设计过程**一旦您了解了如何将输入信息表示为数据并将输出数据解释为信息，则将根据一个简单的过程来进行单个功能的设计：

1. 表达你如何表示信息为数据。

``` racket
; We use numbers to represent centimeters.
```

为您认为对程序成功至关重要的数据类别制定数据定义，例如温度定义。

2. 写下签名，目的声明和函数标头。

函数签名是一种注释，它告诉您的设计读者该函数消耗多少输入，从中提取哪些类以及产生什么样的数据。 这是分别用于功能的三个示例：

``` racket
; String -> Number
```

- 消耗一个sring 一个数 一个图形 产生一个图形

``` racket
; String Number Image -> Image
```

停止！ 此函数产生什么？
目的陈述是BSL注释，它在一行中总结了函数的目的。 如果您对目的陈述有疑问，请写下问题的最短答案
该函数计算什么？

程序的每个读者都应该了解函数计算的内容，而不必阅读函数本身。
多功能程序还应附带目的说明。 的确，优秀的程序员编写了两个目的声明：一个供可能需要修改代码的读者使用，另一个供希望使用该程序但不阅读该程序的人士使用。

最后，标头是一种简单的函数定义，也称为存根。 为签名中的每一类输入选择一个变量名； 函数的主体可以是输出类中的任何数据。 这三个函数头与上述三个签名匹配：

``` racket
(define (f a-string) 0)

(define (g n) "a")

(define (h num str img) (empty-scene 100 100))
```

我们的参数名称反映了该参数代表的数据类型。 有时，您可能希望使用暗示参数目的的名称。
在制定目的陈述时，通常使用参数名称来澄清要计算的内容。 例如，

``` racket
; Number String Image -> Image 
; adds s to img,
; y pixels from the top and 10 from the left 
(define (add-image y s img)
  (empty-scene 100 100))
```

